{% extends 'base.html' %}
{% block content %}
<h1 class="text-2xl font-semibold mb-4">Edit Prospect: {{ prospect.name }}</h1>

<form method="post" class="bg-white p-6 rounded shadow max-w-2xl space-y-4">
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Client/Business *</label>
    <select name="client_id" required class="w-full border border-gray-300 rounded p-3">
        {% for client in clients %}
        <option value="{{ client.id }}" {% if client.id == prospect.client_id %}selected{% endif %}>
            {{ client.name }}
        </option>
        {% endfor %}
    </select>
    </div>
    
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Prospect Name *</label>
    <input name="name" required class="w-full border border-gray-300 rounded p-3" 
           value="{{ prospect.name }}" />
    </div>
</div>

<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
    <input name="email" type="email" class="w-full border border-gray-300 rounded p-3" 
           value="{{ prospect.email or '' }}" />
    </div>
    
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Phone</label>
    <input name="phone" type="tel" class="w-full border border-gray-300 rounded p-3" 
           value="{{ prospect.phone or '' }}" />
    </div>
</div>

<div>
<label class="block text-sm font-medium text-gray-700 mb-1">Address</label>
<input name="address" class="w-full border border-gray-300 rounded p-3" 
       value="{{ prospect.address or '' }}" />
</div>

<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Lead Source</label>
    <select name="source" class="w-full border border-gray-300 rounded p-3">
        <option value="manual" {% if prospect.source == 'manual' %}selected{% endif %}>Manual Entry</option>
        <option value="phone" {% if prospect.source == 'phone' %}selected{% endif %}>Phone Call</option>
        <option value="website" {% if prospect.source == 'website' %}selected{% endif %}>Website</option>
        <option value="walk-in" {% if prospect.source == 'walk-in' %}selected{% endif %}>Walk-in</option>
        <option value="referral" {% if prospect.source == 'referral' %}selected{% endif %}>Referral</option>
        <option value="social_media" {% if prospect.source == 'social_media' %}selected{% endif %}>Social Media</option>
        <option value="advertising" {% if prospect.source == 'advertising' %}selected{% endif %}>Advertising</option>
        <option value="other" {% if prospect.source == 'other' %}selected{% endif %}>Other</option>
    </select>
    </div>
    
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
    <select name="status" class="w-full border border-gray-300 rounded p-3">
        <option value="new" {% if prospect.status == 'new' %}selected{% endif %}>New</option>
        <option value="contacted" {% if prospect.status == 'contacted' %}selected{% endif %}>Contacted</option>
        <option value="qualified" {% if prospect.status == 'qualified' %}selected{% endif %}>Qualified</option>
        <option value="quoted" {% if prospect.status == 'quoted' %}selected{% endif %}>Quoted</option>
        <option value="scheduled" {% if prospect.status == 'scheduled' %}selected{% endif %}>Scheduled</option>
        <option value="won" {% if prospect.status == 'won' %}selected{% endif %}>Won</option>
        <option value="lost" {% if prospect.status == 'lost' %}selected{% endif %}>Lost</option>
    </select>
    </div>
    
    <div>
    <label class="block text-sm font-medium text-gray-700 mb-1">Estimated Value ($)</label>
    <input name="estimated_value" type="number" step="0.01" min="0" 
           class="w-full border border-gray-300 rounded p-3" 
           value="{{ prospect.estimated_value or 0 }}" />
    </div>
</div>

<div>
<label class="block text-sm font-medium text-gray-700 mb-1">Notes</label>
<textarea name="notes" rows="4" class="w-full border border-gray-300 rounded p-3">{{ prospect.notes or '' }}</textarea>
</div>

<div class="bg-gray-50 border rounded p-3">
<label class="flex items-center">
    <input type="checkbox" name="update_last_contact" class="mr-2" />
    <span class="text-sm">Update "Last Contact" timestamp to now</span>
</label>
</div>

<div class="flex gap-3">
<button type="submit" class="bg-blue-600 text-white px-6 py-3 rounded hover:bg-blue-700">
    Update Prospect
</button>
<a href="/prospects" class="bg-gray-500 text-white px-6 py-3 rounded hover:bg-gray-600">
    Cancel
</a>
{% if prospect.status == 'qualified' %}
<a href="/schedule/new?prospect_id={{ prospect.id }}" 
   class="bg-green-600 text-white px-6 py-3 rounded hover:bg-green-700">
    Schedule Work
</a>
{% endif %}
</div>
</form>

<div class="mt-6 bg-white rounded shadow p-4">
<h3 class="font-medium mb-2">Prospect History</h3>
<div class="text-sm text-gray-700 space-y-1">
<div>Created: {{ prospect.created_at.strftime('%Y-%m-%d %H:%M') }}</div>
{% if prospect.last_contact %}
<div>Last Contact: {{ prospect.last_contact.strftime('%Y-%m-%d %H:%M') }}</div>
{% endif %}
</div>
</div>

{% endblock %}